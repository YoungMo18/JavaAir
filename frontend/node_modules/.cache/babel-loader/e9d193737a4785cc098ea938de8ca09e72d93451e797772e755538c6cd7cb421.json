{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Navigation}from\"./navigation/Navigation\";import{Footer}from\"./footer/Footer\";import{useParams}from\"react-router-dom\";import{getDatabase,ref,get,update,remove,set as firebaseSet,push}from\"firebase/database\";import{useNavigate}from\"react-router-dom\";import Carousel from\"react-bootstrap/Carousel\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export function DetailFlightPage(props){const[flightObject,setFlightObject]=useState(null);const[successBook,setSuccessBook]=useState(false);const flightID=useParams().flight;const navigate=useNavigate();useEffect(()=>{const fetchFlightDetails=async()=>{const db=getDatabase();const flightRef=ref(db,\"flight/\".concat(flightID));try{const snapshot=await get(flightRef);if(snapshot.exists()){setFlightObject(snapshot.val());}else{console.log(\"No flight data available\");}}catch(error){console.error(\"Error fetching flight details:\",error);}};fetchFlightDetails();},[flightID]);if(!flightObject){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading flight details...\"});}const inputDBEntries=async()=>{const db=getDatabase();const username=localStorage.getItem(\"username\");const bookRef=ref(db,\"bookedFlight/\".concat(username));const newBookRef=push(bookRef);await firebaseSet(newBookRef,{flightID:flightID,from:flightObject.from,to:flightObject.to,departureTime:flightObject.departureTime,arrivalTime:flightObject.arrivalTime,departureDate:flightObject.departureDate}).then(()=>console.log(\"Data saved successfully!\")).catch(err=>console.log(err));setSuccessBook(true);};const updateQuantityDB=async()=>{const db=getDatabase();const flightRef=ref(db,\"flight/\".concat(flightID));const newQuantity=flightObject.quantity-1;if(newQuantity!==0){await update(flightRef,{quantity:newQuantity}).then(()=>{console.log(\"Updated quantity\");}).catch(err=>{console.log(err);});}else{setTimeout(async()=>{await remove(flightRef).then(()=>{console.log(\"Flight removed\");});},3500);}setTimeout(()=>{navigate(\"/history\");},2000);};const handleSubmit=async event=>{event.preventDefault();await inputDBEntries();await updateQuantityDB();};let carouselItems=flightObject.images.map((img,index)=>/*#__PURE__*/_jsx(Carousel.Item,{children:/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"Flight scenery \".concat(index+1)})},index));return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsx(Navigation,{})}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flight-detail\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Flight Details\"}),/*#__PURE__*/_jsxs(\"article\",{className:\"flight-detail-card\",children:[/*#__PURE__*/_jsx(Carousel,{indicators:false,prevLabel:\"\",nextLabel:\"\",children:carouselItems}),/*#__PURE__*/_jsxs(\"p\",{children:[\"From: \",flightObject.from]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"To: \",flightObject.to]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Date: \",flightObject.departureDate]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Departure Time: \",flightObject.departureTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Arrival Time: \",flightObject.arrivalTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Quantity: \",flightObject.quantity]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Book Flight\"}),successBook&&/*#__PURE__*/_jsx(\"div\",{className:\"success-msg\",children:\"Successfully booked... Redirecting to history...\"})]})]})}),/*#__PURE__*/_jsx(\"footer\",{children:/*#__PURE__*/_jsx(Footer,{})})]});}export default DetailFlightPage;","map":{"version":3,"names":["React","useState","useEffect","Navigation","Footer","useParams","getDatabase","ref","get","update","remove","set","firebaseSet","push","useNavigate","Carousel","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DetailFlightPage","props","flightObject","setFlightObject","successBook","setSuccessBook","flightID","flight","navigate","fetchFlightDetails","db","flightRef","concat","snapshot","exists","val","console","log","error","children","inputDBEntries","username","localStorage","getItem","bookRef","newBookRef","from","to","departureTime","arrivalTime","departureDate","then","catch","err","updateQuantityDB","newQuantity","quantity","setTimeout","handleSubmit","event","preventDefault","carouselItems","images","map","img","index","Item","src","alt","className","indicators","prevLabel","nextLabel","onClick"],"sources":["/Users/muhammadputra/Desktop/JavaAir/frontend/src/components/DetailFlightPage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Navigation } from \"./navigation/Navigation\";\nimport { Footer } from \"./footer/Footer\";\nimport { useParams } from \"react-router-dom\";\nimport {\n  getDatabase,\n  ref,\n  get,\n  update,\n  remove,\n  set as firebaseSet,\n  push,\n} from \"firebase/database\";\nimport { useNavigate } from \"react-router-dom\";\nimport Carousel from \"react-bootstrap/Carousel\";\n\nexport function DetailFlightPage(props) {\n  const [flightObject, setFlightObject] = useState(null);\n  const [successBook, setSuccessBook] = useState(false);\n  const flightID = useParams().flight;\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchFlightDetails = async () => {\n      const db = getDatabase();\n      const flightRef = ref(db, `flight/${flightID}`);\n\n      try {\n        const snapshot = await get(flightRef);\n        if (snapshot.exists()) {\n          setFlightObject(snapshot.val());\n        } else {\n          console.log(\"No flight data available\");\n        }\n      } catch (error) {\n        console.error(\"Error fetching flight details:\", error);\n      }\n    };\n\n    fetchFlightDetails();\n  }, [flightID]);\n\n  if (!flightObject) {\n    return <p>Loading flight details...</p>;\n  }\n\n  const inputDBEntries = async () => {\n    const db = getDatabase();\n    const username = localStorage.getItem(\"username\");\n    const bookRef = ref(db, `bookedFlight/${username}`);\n\n    const newBookRef = push(bookRef);\n\n    await firebaseSet(newBookRef, {\n      flightID: flightID,\n      from: flightObject.from,\n      to: flightObject.to,\n      departureTime: flightObject.departureTime,\n      arrivalTime: flightObject.arrivalTime,\n      departureDate: flightObject.departureDate,\n    })\n      .then(() => console.log(\"Data saved successfully!\"))\n      .catch((err) => console.log(err));\n\n    setSuccessBook(true);\n  };\n\n  const updateQuantityDB = async () => {\n    const db = getDatabase();\n    const flightRef = ref(db, `flight/${flightID}`);\n    const newQuantity = flightObject.quantity - 1;\n    if (newQuantity !== 0) {\n      await update(flightRef, {\n        quantity: newQuantity,\n      })\n        .then(() => {\n          console.log(\"Updated quantity\");\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    } else {\n      setTimeout(async () => {\n        await remove(flightRef).then(() => {\n          console.log(\"Flight removed\");\n        });\n      }, 3500);\n    }\n    setTimeout(() => {\n      navigate(\"/history\");\n    }, 2000);\n  };\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    await inputDBEntries();\n    await updateQuantityDB();\n  };\n\n  let carouselItems = flightObject.images.map((img, index) => (\n    <Carousel.Item key={index}>\n      <img src={img} alt={`Flight scenery ${index + 1}`} />\n    </Carousel.Item>\n  ));\n\n  return (\n    <>\n      <header>\n        <Navigation />\n      </header>\n      <main>\n        <div className=\"flight-detail\">\n          <h1>Flight Details</h1>\n          <article className=\"flight-detail-card\">\n            <Carousel indicators={false} prevLabel=\"\" nextLabel=\"\">\n              {carouselItems}\n            </Carousel>\n            <p>From: {flightObject.from}</p>\n            <p>To: {flightObject.to}</p>\n            <p>Date: {flightObject.departureDate}</p>\n            <p>Departure Time: {flightObject.departureTime}</p>\n            <p>Arrival Time: {flightObject.arrivalTime}</p>\n            <p>Quantity: {flightObject.quantity}</p>\n            <button onClick={handleSubmit}>Book Flight</button>\n            {successBook && (\n              <div className=\"success-msg\">\n                Successfully booked... Redirecting to history...\n              </div>\n            )}\n          </article>\n        </div>\n      </main>\n      <footer>\n        <Footer />\n      </footer>\n    </>\n  );\n}\n\nexport default DetailFlightPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}